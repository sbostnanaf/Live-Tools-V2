events {
    worker_connections 1024;
}

http {
    upstream backend {
        server 172.17.0.1:8000;
    }
    
    server {
        listen 80;
        listen 443 ssl http2;
        
        ssl_certificate /etc/ssl/certs/nginx-selfsigned.crt;
        ssl_certificate_key /etc/ssl/private/nginx-selfsigned.key;
        
        location / {
            root /usr/share/nginx/html;
            try_files \ \/ /index.html;
        }
        
        location /api/ {
            proxy_pass http://backend/api/;
            proxy_set_header Host \;
            proxy_set_header X-Real-IP \;
            proxy_set_header X-Forwarded-For \;
            proxy_set_header X-Forwarded-Proto \;
        }
        
        location /health {
            proxy_pass http://backend/health;
        }
    }
}
